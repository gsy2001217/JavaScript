# 	红宝书第四章：变量，作用域，内存问题

## 一：基本类型和引用类型的值

​	ECMAScript 变量可能包含两种数据类型的值，一种是**基本数据类型**，指的是简单的数据段；一种是**引用数据类型值**是那些由多个值构成的对象。

### 	动态属性：

​				引用数据类型可以随意添加属性个方法，也可以改变和删除属性和方法，但是基本类型不可以。

### 	赋值变量值：

#### 				基本数据类型：

​				在新对象变量创建一个新值，然后复制过去。例如：

```javascript
var num1=5;
var num2=num1;//5
```

​				复制前：

| 对象名称 | 数值 |
| -------- | ---- |
| num1     | 5    |
|          |      |

​				复制后：

| 对象名称 | 数值 |
| -------- | ---- |
| num1     | 5    |
| num2     | 5    |

#### 				引用数据类型：

​				复制一个新对象实例，两个对象实例都指向同一个对象，即公用一个对象信息。

​                 <img src="file:///D:\Documents\Tencent Files\1932683863\Image\C2C\0043846671C9DD9AA37FDDBE69A7BD4B.jpg" alt="img" style="zoom: 50%;" /> 

### 	检测类型：

我们使用  **typeof**  可以确定一个值是哪一种基本类型，确定一个值是哪一种引用类型用 **instanceof **操作符。操作语法如下:

```javascript
result = variable instanceof constructor;
//返回true/false，判断variable是否是constructor类型对象
```

## 二：执行环境及作用域：

​	**什么是执行环境：执行环境定义了变量或函数有权访问的决定了它们各自的行为**

​			当代码在一个环境访问的时候回创建变量对象的一个**作用域链**，作用域链保证对执行环境**有权访问**的所有变量或者函数的**有序访问**。作用域链的前端始终是当前执行代码的环境变量对象，全局执行环境变量的环境对象始终是作用域链的最后一个对象。

**没有块级作用域：**

​		JavaScript**没有块级作用域的说法**，所有当fou语句创建的变量i即使当for循环执行结束后依旧存在于循环外部的执行环境。

​		当使用var定义的变量会被自动添加到最接近的环境中，在函数中最接近的是函数的局部变量，在with语句中则是函数环境，如果初始化没有使用var则被添加到全局变量。

​		在搜索标识符的时候，如果局部环境存在同名的标识符，就不会使用父环境的标识符（从下往上，谁近使用谁）。

**垃圾回收：**

​		方法：1：最主流的，标记清除。垃圾收集器在运行时给存储在内存的所有变量标记，然后去掉环境以及被环境中变量引用的变量的标记，在此之后被标记的视为要删除的变量。（**先标记，在将有用的变量标记去除，最会删除剩余无用的。）**

​				2：引用计数：,跟踪记录每个值被引用的次数。

**管理内存：**

​		JavaScript分配给web的可用内存数量通常小于桌面应用程序，这样是出于安全考虑，防止运行JavaScript的网页耗尽全部内存导致系统崩溃。

​		解除引用：当数据不再使用的时候通过将他的值设置为null来释放内存。

​		**解除一个值的引用并不意味这自动回收改值所占用的内存，解除引用的真正作用是让值脱离执行环境，以方便垃圾收集器下次运行的时候将其回收。**		

